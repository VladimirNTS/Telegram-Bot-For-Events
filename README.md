# Телеграм бот для огранизации мероприятий

## Архитектура админ-панели и логика системы

### 0. Назначение документа
**Документ описывает:**
- структуру админ-панели
- сущности системы
- основные пользовательские сценарии
- связи между Telegram-ботом и админкой

**Документ используется:**
- дизайнером для построения экранов и UX
- разработчиком как логическая карта системы

### 1. Архитектура системы
**Компоненты:**
- Telegram Bot (UI + уведомления)
- Web Admin Panel (основная логика)
- База данных
- Платёжный провайдер (Ю-Касса)
- Backend API (связывает базу данных, оплату и интерфейс)

Принцип:
Вся бизнес-логика и решения - в админке
Бот - только клиент

### 2. Структура работы админ панели
**Левое меню с разделами**:
- Главаня страница (Дашборд)
- Мероприятия
- Регистрации
- Заявки вытавки
- Заявки партнеры
- Пользователи
- Очередь
- Платежи
- Документы
- Отзывы
- Уведомление
- QR-коды
- Чёрный список
- Настройки 

#### 2.1. Главная страница (Дашборд)
Страница дашборда разделена На блоки с базовой статистикой. 
- Блок "Новые заявки" - количество новых заявок за последние 24 часа.
- Блок "Ожидают оплаты" - количество и ссыма всех подтвержденных и не оплаченых заявок на выставку
- Блок "Очередь" - количество не обработанных заявок на выставку
- Таблица "Ближайшие мероприятия" - список мероприятий на следующие семь дней.
- Таблица "Последнии регистрации" - последнии 5 регистраций на выставку и их статусы

**Также должны быть кнопки**
- "Создать мероприятие" - открывает форму создания мероприятия (описана ниже)
- "Скачать QR бота" - скачивает самый базовый QR код на бота

#### 2.2. Мероприятия
На этой вкладке можно просматривать все мероприятия, изменять их, создавать новые, удалять.

##### Таблица мероприятий
Табллица со списком всех мероприятий с фильтрами по дате, разделу, статусу, платно/бесплатно и поиск по названию. У каждого мероприятия должна быть кнопка редактирования и удаления. При удаление, если мероприятие бесплатное, то оно удалиться без проблем, а участникам отправиться уведомление об отменене, если платное, то статус перейдет в отменено и новые записи не будут приниматься, но можно будет проматривать всех пользователей, чтобы вернуть деньги.

##### Создание мероприятий
Мероприятие создаеться по кнопке в правом верхнем углу. После этого откроеться форма, в которой нуно будет заполнить:
- Название мероприятия
- Дату и время начала мероприятия
- выбрать раздел (бизнес мероприятия или клуб молодых семей)
- Место проведения
- описание
- Условия участия (просто текст, который выдаст бот пользователю перед записью)
- Анкета, указать какие поля нужны для анкеты. В зависимости от раздела ставяться по умолчанию с возможностью добавить новые:
  Анкета по умолчанию для клуба молодых семей:
  - Имя
  - телефон
  - Количество детей
  - Город / район (не обязательное)
  
  Анкета по умолчанию для бизнес мероприятия:
  - Имя
  - телефон
  - сфера деятельности
  - Город / район
 
- Стоимость участия (если бесплатно, то просто 0)
- Часовой пояс (по умолчанию береться из настроик проекта)

#### 2.3. Регистрации

На этой вкладке отображаются все записи пользователей на мероприятия Клуба молодых семей и Бизнес мероприятий.

#### Таблица регистраций

Таблица со списком всех регистраций.

Фильтры:
- мероприятие
- раздел (Клуб молодых семей / Бизнес мероприятия)
- статус регистрации (подтверждён / в листе ожидания / отменён)
- статус оплаты (ожидает оплаты / оплачено / возврат / ошибка)
- дата регистрации
- поиск по имени или телефону

Колонки:
- Имя
- Телефон
- Мероприятие
- Раздел
- Статус регистрации
- Статус оплаты
- Дата регистрации
- Кнопка просмотра

#### Карточка регистрации

Карточка регистрации содержит:
- все данные анкеты пользователя
- статус регистрации
- статус оплаты
- историю изменений
- дату и время регистрации
- информацию о нахождении в очереди (если применимо)

Кнопки:
- Подтвердить вручную
- Отменить участие
- Связаться (переход в Telegram)

При отмене участия:
- место освобождается
- автоматически запускается логика приглашения следующего пользователя из очереди

#### 2.4. Пользователи

Раздел предназначен для хранения и управления базой пользователей.

#### Таблица пользователей

Фильтры:
- статус (активный / заблокирован)
- выбранный раздел
- дата регистрации
- поиск по имени / телефону / telegram id

Колонки:
- Имя
- Телефон
- Telegram ID
- Выбранный раздел (Клуб молодых семей, бизнес, выставка, партнер)
- Количество мероприятий
- Последняя активность
- Статус

#### Карточка пользователя

Содержит:
- Все данные из колонок
- история регистраций
- история оплат
- оставленные отзывы
- заметки администратора
- статус в чёрном списке

Кнопки:
- Редактировать данные
- Заблокировать / разблокировать
- Перейти в Telegram

#### 2.5. Очередь

Раздел предназначен для управления листами ожидания.

##### Общий список очередей

Отображаются мероприятия, у которых есть активная очередь.

Колонки:
- Мероприятие
- Раздел
- Количество человек в очереди
- Количество приглашённых
- Кнопка просмотра

##### Очередь конкретного мероприятия

Отображается список пользователей в порядке очереди.

Колонки:
- Позиция
- Имя
- Телефон
- Статус (ожидает / приглашён / истёк срок)
- Время приглашения
- Время окончания 16 часов

Администратор может:
- удалить пользователя из очереди
- пригласить вручную
- продлить время ожидания

#### 2.6. Платежи

Раздел предназначен для контроля всех оплат.

##### Таблица платежей

Фильтры:
- мероприятие
- раздел
- статус (ожидает / оплачено / возврат / ошибка)
- дата
- поиск по имени или телефону

Колонки:
- Имя
- Мероприятие
- Сумма
- Статус
- Дата создания
- Способ оплаты

##### Карточка платежа

Содержит:
- данные пользователя
- данные мероприятия
- сумма
- статус
- id транзакции в Ю-Касса
- лог изменений статуса

Возвраты производятся вручную через Ю-Касса, после чего статус фиксируется в админке.

#### 2.7. Документы

Раздел предназначен для генерации и хранения документов.

#### Шаблоны документов

Возможность:
- загрузить шаблон договора
- загрузить шаблон счёта
- загрузить шаблон акта
- указать переменные для автоподстановки

#### Список документов

Фильтры:
- тип документа
- статус
- дата создания
- мероприятие

Колонки:
- Тип
- Пользователь / организация
- Мероприятие
- Статус
- Дата создания
- Кнопка скачать

Документы могут автоматически отправляться пользователю в Telegram после генерации.

### 2.8. Отзывы

Раздел предназначен для просмотра обратной связи.

#### Таблица отзывов

Фильтры:
- мероприятие
- раздел
- оценка
- дата

Колонки:
- Имя
- Мероприятие
- Оценка
- Текст отзыва
- Дата

### 2.9. Уведомления

Раздел предназначен для управления текстами сообщений.

Можно редактировать:
- напоминание за 48 часов
- напоминание за 24 часа
- напоминание за 3 часа
- напоминание за 1 час
- сообщение о подтверждении регистрации
- сообщение об отмене мероприятия
- сообщение о приглашении из очереди

Также отображается журнал отправленных уведомлений:
- кому отправлено
- какое сообщение
- дата и время
- статус доставки

### 2.10. QR-коды

Раздел предназначен для генерации QR-кодов.

Поддержка:
- общий QR на запуск бота
- QR на раздел (Клуб молодых семей / Бизнес мероприятия)
- QR на конкретное мероприятие

Возможность:
- предпросмотр
- скачивание

### 2.11. Чёрный список

Раздел для управления заблокированными пользователями.

Таблица:
- Имя
- Телефон
- Причина блокировки
- Дата добавления

Пользователь в чёрном списке:
- не может регистрироваться
- не может вставать в очередь

### 2.12. Настройки

В разделе настроек можно указать:

- Часовой пояс проекта
- Тихие часы для уведомлений
- Время ожидания подтверждения из очереди (по умолчанию 16 часов)
- Ключи интеграции Ю-Касса
- Ссылку на политику обработки персональных данных
- Текст договора публичной оферты
- Администраторов системы и их права доступа

### Структура телеграм бота 


